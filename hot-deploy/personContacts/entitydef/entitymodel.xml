<?xml version="1.0" encoding="UTF-8"?>
<entitymodel xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/entitymodel.xsd">
    <!-- ========================================================= -->
    <!-- ======================== Defaults ======================= -->
    <!-- ========================================================= -->
    <title>Entity of PersonContacts Component</title>
    <description>None</description>
    <copyright></copyright>
    <version></version>

	<!--活动的内容附件中间表-->
	<entity entity-name="MarketingCampaignContent" package-name="com.banfftech.personerp" title="中间表">

		<field name="marketingCampaignId" type="id-ne"/>       <!-- PK -->
		<field name="contentId" type="id-ne"/>	               <!-- PK -->
		<prim-key field="marketingCampaignId"/>
		<prim-key field="contentId"/>
	</entity>
<!--活动附件类型-->
	<entity entity-name="MarketingCampaignContentType"
			package-name="com.banfftech.personerp"
			title="活动附件类型">
		<field name="marketingCampaignContentTypeId" type="id-ne"></field>
		<field name="parentTypeId" type="id"></field>
		<field name="hasTable" type="indicator"></field>
		<field name="description" type="description"></field>

		<prim-key field="marketingCampaignContentTypeId"/>
		<relation type="one" fk-name="MARKET_TYP_PAR" title="Parent" rel-entity-name="MarketingCampaignContentType">
			<key-map field-name="parentTypeId" rel-field-name="marketingCampaignContentTypeId"/>
		</relation>
	</entity>

	<view-entity entity-name="findTelecomNumberByPartyId" package-name="">
		<member-entity entity-alias="PCM" entity-name="PartyContactMech"/>
		<member-entity entity-alias="PCMP" entity-name="PartyContactMechPurpose"/>
		<member-entity entity-alias="CM" entity-name="ContactMech"/>
		<member-entity entity-alias="TN" entity-name="TelecomNumber"/>
		<alias entity-alias="PCM" name="partyId" field="partyId"/>
		<alias entity-alias="PCM" name="fromDate" field="fromDate"/>
		<alias entity-alias="PCM" name="thruDate" field="thruDate"/>
		<alias entity-alias="PCMP" name="thruDatePartyPu" field="thruDate"/>
		<alias entity-alias="PCM" name="contactMechId" field="contactMechId"/>
		<alias entity-alias="PCMP" name="contactMechPurposeTypeId" field="contactMechPurposeTypeId"/>
		<alias entity-alias="CM" name="contactMechTypeId" field="contactMechTypeId"/>
		<alias entity-alias="TN" name="contactNumber" field="contactNumber"/>
		<view-link entity-alias="PCM" rel-entity-alias="PCMP">
			<key-map field-name="partyId" rel-field-name="partyId"/>
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
			<entity-condition>
				<condition-list>
					<condition-expr entity-alias="PCM" field-name="thruDate" operator="equals" value=""/>
					<condition-expr entity-alias="PCMP" field-name="thruDate" operator="equals" value=""/>
				</condition-list>
			</entity-condition>
		</view-link>
		<view-link entity-alias="PCM" rel-entity-alias="CM">
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
		</view-link>
		<view-link entity-alias="PCM" rel-entity-alias="TN">
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
		</view-link>
		<entity-condition>
			<order-by field-name="-fromDate"/>
		</entity-condition>
	</view-entity>
	
	<view-entity entity-name="findEmailByPartyId" package-name="">
		<member-entity entity-alias="PCM" entity-name="PartyContactMech"/>
		<member-entity entity-alias="PCMP" entity-name="PartyContactMechPurpose"/>
		<member-entity entity-alias="CM" entity-name="ContactMech"/>
		<alias entity-alias="PCM" name="partyId" field="partyId"/>
		<alias entity-alias="PCM" name="fromDate" field="fromDate"/>
		<alias entity-alias="PCM" name="thruDate" field="thruDate"/>
		<alias entity-alias="PCM" name="contactMechId" field="contactMechId"/>
		<alias entity-alias="PCMP" name="thruDatePartyPu" field="thruDate"/>
		<alias entity-alias="PCMP" name="contactMechPurposeTypeId" field="contactMechPurposeTypeId"/>
		<alias entity-alias="CM" name="infoString" field="infoString"/>
		<alias entity-alias="CM" name="contactMechTypeId" field="contactMechTypeId"/>
		<view-link entity-alias="PCM" rel-entity-alias="PCMP">
			<key-map field-name="partyId" rel-field-name="partyId"/>
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
			<entity-condition>
				<condition-list>
					<condition-expr entity-alias="PCM" field-name="thruDate" operator="equals" value=""/>
					<condition-expr entity-alias="PCMP" field-name="thruDate" operator="equals" value=""/>
				</condition-list>
			</entity-condition>
		</view-link>
		<view-link entity-alias="PCM" rel-entity-alias="CM">
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
		</view-link>
		<entity-condition>
			<order-by field-name="-fromDate"/>
		</entity-condition>
	</view-entity>
	
	<view-entity entity-name="findPostalAddressByPartyId" package-name="">
		<member-entity entity-alias="PCM" entity-name="PartyContactMech"/>
		<member-entity entity-alias="PCMP" entity-name="PartyContactMechPurpose"/>
		<member-entity entity-alias="CM" entity-name="ContactMech"/>
		<member-entity entity-alias="PA" entity-name="PostalAddress"/>
		<member-entity entity-alias="G" entity-name="Geo"/>
		
		<member-entity entity-alias="G1" entity-name="Geo"/><!-- 找出市对应的GeoId -->
		<member-entity entity-alias="G2" entity-name="Geo"/><!-- 找出区对应的GeoId -->
		
		<alias entity-alias="PCM" name="partyId" field="partyId"/>
		<alias entity-alias="PCM" name="fromDate" field="fromDate"/>
		<alias entity-alias="PCM" name="contactMechId" field="contactMechId"/>
		<alias entity-alias="PCMP" name="thruDate" field="thruDate"/>
		<alias entity-alias="PCMP" name="contactMechPurposeTypeId" field="contactMechPurposeTypeId"/>
		<alias entity-alias="CM" name="contactMechTypeId" field="contactMechTypeId"/>
		<alias entity-alias="PA" name="address1" field="address1"/>
		<alias entity-alias="PA" name="address2" field="address2"/>
		<alias entity-alias="PA" name="city" field="city"/>
		<alias entity-alias="PA" name="toName" field="toName"/>
		<alias entity-alias="PA" name="attnName" field="attnName"/>
		<alias entity-alias="PA" name="postalCode" field="postalCode"/>
		<alias entity-alias="PA" name="countryGeoId" field="countryGeoId"/>
		<alias entity-alias="PA" name="stateProvinceGeoId" field="stateProvinceGeoId"/>
		<alias entity-alias="G" name="geoName" field="geoName"/>
		<alias entity-alias="G1" name="geoIdCity" field="geoId"/>
		<alias entity-alias="G2" name="geoIdArea" field="geoId"/>
		<view-link entity-alias="PCM" rel-entity-alias="PCMP">
			<key-map field-name="partyId" rel-field-name="partyId"/>
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
			<entity-condition>
				<condition-list>
					<condition-expr entity-alias="PCM" field-name="thruDate" operator="equals" value=""/>
					<condition-expr entity-alias="PCMP" field-name="thruDate" operator="equals" value=""/>
				</condition-list>	
			</entity-condition>
		</view-link>
		<view-link entity-alias="PCM" rel-entity-alias="CM">
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
		</view-link>
		<view-link entity-alias="PCM" rel-entity-alias="PA">
			<key-map field-name="contactMechId" rel-field-name="contactMechId"/>
		</view-link>
		<view-link entity-alias="PA" rel-entity-alias="G">
			<key-map field-name="stateProvinceGeoId" rel-field-name="geoId"/>
		</view-link>
		
		<view-link entity-alias="PA" rel-entity-alias="G1">
			<key-map field-name="city" rel-field-name="geoName"/>
		</view-link>
		<view-link entity-alias="PA" rel-entity-alias="G2">
			<key-map field-name="address2" rel-field-name="geoName"/>
		</view-link>
		
		<entity-condition>
			<order-by field-name="-fromDate"/>
		</entity-condition>
	</view-entity>

	<!-- 我参与的活动 -->
	<view-entity entity-name="MarketingCampaignAndRole">
		<member-entity entity-name="MarketingCampaign" entity-alias="MC"/>
		<member-entity entity-name="MarketingCampaignRole" entity-alias="MCR"/>

		<alias-all entity-alias="MC"/>
		<alias-all entity-alias="MCR"/>
		<view-link entity-alias="MC" rel-entity-alias="MCR" >
			<key-map  field-name="marketingCampaignId"/>
			<entity-condition>
				<condition-list>
					<condition-expr field-name="roleTypeId" entity-alias="MCR" operator="equals" value="CAMPAIGN_MEMBER"/>
				</condition-list>
				<order-by field-name="-fromDate"/>
			</entity-condition>
		</view-link>


	</view-entity>


	<!-- 活动中的人员简介 -->
	<view-entity entity-name="WorkEffortPartyAssignmentAndPerson">
		<member-entity entity-name="WorkEffortPartyAssignment" entity-alias="WorkEffortPartyAssignment"/>
		<member-entity entity-name="Person" entity-alias="Person"/>
		<alias entity-alias="WorkEffortPartyAssignment" field="partyId" name="partyId"/>
		<alias entity-alias="WorkEffortPartyAssignment" field="roleTypeId" name="roleTypeId"/>
		<alias entity-alias="WorkEffortPartyAssignment" field="fromDate" name="fromDate"/>
		<alias entity-alias="WorkEffortPartyAssignment" field="workEffortId" name="workEffortId"/>
		<alias-all entity-alias="Person"/>
		<!--<alias entity-alias="Person" field="partyId" name="partyId"/>-->
		<!--<alias entity-alias="Person" field="lastName" name="lastName"/>-->
		<!--<alias entity-alias="Person" field="firstName" name="firstName"/>-->
		<!--<alias entity-alias="Person" field="nickname" name="nickname"/>-->
		<view-link entity-alias="WorkEffortPartyAssignment" rel-entity-alias="Person" >
			<key-map  field-name="partyId" rel-field-name="partyId"/>
		</view-link>
	</view-entity>


	<!-- 活动中的人员/头像内容-->
	<view-entity entity-name="WorkEffortPartyAssignmentAndJoinParty">
		<member-entity entity-name="WorkEffortPartyAssignment" entity-alias="WP"/>
		<!--<member-entity entity-name="PartyContent" entity-alias="PC"/>-->
		<member-entity entity-name="Person" entity-alias="Person"/>

		<alias entity-alias="WP" field="partyId" name="partyId"/>
		<alias entity-alias="WP" field="roleTypeId" name="roleTypeId"/>
		<alias entity-alias="WP" field="workEffortId" name="workEffortId"/>
		<alias entity-alias="Person" field="lastName" name="lastName"/>
		<alias entity-alias="Person" field="firstName" name="firstName"/>
		
		<alias entity-alias="Person" field="nickname" name="nickname"/>
		<!--<alias entity-alias="PC" field="partyId" name="partyId"/>-->
		<!--<alias entity-alias="PC" field="contentId" name="contentId"/>-->
		<!--<alias entity-alias="PC" field="partyContentTypeId" name="partyContentTypeId"/>-->

		<view-link entity-alias="WP" rel-entity-alias="Person" >
			<key-map  field-name="partyId"/>
		</view-link>
			<entity-condition>
				<!--<condition-list>-->
				<!--<condition-expr field-name="partyContentTypeId" entity-alias="PC" operator="equals" value="LGOIMGURL"/>-->
				<!--</condition-list>-->

				<condition-list>
					<condition-expr field-name="roleTypeId" entity-alias="WP" operator="equals" value="ACTIVITY_MEMBER"/>
				</condition-list>
			</entity-condition>



	</view-entity>


	<!-- 参与投票的回答的人的详细详细 -->
	<view-entity entity-name="SurveyResponseAndAnswerAndPerson">
		<member-entity entity-name="SurveyResponseAndAnswer" entity-alias="SRAA"/>
		<member-entity entity-name="SurveyQuestion" entity-alias="SQ"/>
		<member-entity entity-name="Person" entity-alias="P"/>

		<!-- 暂不关联Content -->
		<alias name="answerPartyId" field="partyId" entity-alias="SRAA"/>
		<alias name="questionId" field="surveyQuestionId" entity-alias="SQ"/>
		<alias name="question" field="question" entity-alias="SQ"/>

		<alias name="surveyQuestionId" field="surveyQuestionId" entity-alias="SRAA"/>
		<alias name="partyId" field="partyId" entity-alias="P"/>
		<alias name="booleanResponse" field="booleanResponse" entity-alias="SRAA"/>


		<alias name="firstName" field="firstName" entity-alias="P"/>
		<alias name="lastName" field="lastName" entity-alias="P"/>

		<view-link entity-alias="SRAA" rel-entity-alias="SQ">
			<key-map field-name="surveyQuestionId" rel-field-name="surveyQuestionId" />
		</view-link>
		<view-link entity-alias="SRAA" rel-entity-alias="P">
			<key-map field-name="partyId" rel-field-name="partyId" />
		</view-link>

		<entity-condition>
			<condition-list>
				<condition-expr field-name="booleanResponse" entity-alias="SRAA" operator="equals" value="Y"/>
			</condition-list>

		</entity-condition>
	</view-entity>

	<!-- 投票标题列表视图 -->
	<view-entity entity-name="ActivityVotes">
		<member-entity entity-name="WorkEffortSurveyAppl" entity-alias="WS"/>
		<member-entity entity-name="Survey" entity-alias="S"/>

		<alias name="workEffortId" field="workEffortId" entity-alias="WS"/>
		<alias name="surveyId" field="surveyId" entity-alias="S"/>
		<alias name="surveyName" field="surveyName" entity-alias="S"/>
		<alias name="fromDate" field="fromDate" entity-alias="WS"/>


		<view-link entity-alias="WS" rel-entity-alias="S">
			<key-map field-name="surveyId" rel-field-name="surveyId" />
		</view-link>
	</view-entity>


    <!-- 活动中的活动项 -->
	<view-entity entity-name="ActivityAndProject">
		<member-entity entity-name="WorkEffort" entity-alias="ACTIVITY"/>
		<member-entity entity-name="WorkEffort" entity-alias="PROJECT"/>
		<member-entity entity-name="WorkEffortAssoc" entity-alias="RELATION"/>



		<alias entity-alias="ACTIVITY" field="workEffortId" name="activityId"/>
		<alias entity-alias="PROJECT" field="workEffortId" name="projectId"/>
		<alias entity-alias="PROJECT" field="workEffortName" name="workEffortName"/>
		<alias entity-alias="PROJECT" field="actualStartDate" name="actualStartDate"/>
		<alias entity-alias="PROJECT" field="locationDesc" name="locationDesc"/>


		<alias entity-alias="RELATION" field="workEffortIdTo" name="workEffortIdTo"/>
		<alias entity-alias="RELATION" field="workEffortIdFrom" name="workEffortIdFrom"/>
		<alias entity-alias="RELATION" field="workEffortAssocTypeId" name="workEffortAssocTypeId"/>

		<view-link entity-alias="RELATION" rel-entity-alias="ACTIVITY" >
			<key-map  field-name="workEffortIdTo" rel-field-name="workEffortId"/>
		</view-link>
		<view-link entity-alias="RELATION" rel-entity-alias="PROJECT" >
			<key-map  field-name="workEffortIdFrom" rel-field-name="workEffortId"/>
		</view-link>

		<entity-condition>
			<condition-list>
				<condition-expr field-name="workEffortAssocTypeId" entity-alias="RELATION" operator="equals" value="WORK_EFF_DEPENDENCY"/>
			</condition-list>
		</entity-condition>


	</view-entity>


<!-- SSMS -->
	<entity entity-name="SmsValidateCode" package-name="org.ofbiz.personerp.sms" title="短信验证码">
		<description>短信验证码，过期的 且 isValid=Y 的数据都可以清理</description>
		<field name="teleNumber" type="id"></field>
		<field name="smsType" type="id"></field>
		<field name="captcha" type="id"></field>
		<field name="isValid" type="id"></field>
		<field name="fromDate" type="date-time"></field>
		<field name="thruDate" type="date-time"></field>
		<prim-key field="teleNumber"/>
		<prim-key field="captcha"/>
		<prim-key field="fromDate"/>
	</entity>
	<!-- Account :PaymentTemp -->
	<entity entity-name="PartyPaymentInfo" package-name="org.ofbiz.personerp" title="PartyPaymentInfo">
		<description>这是临时记录金额的表</description>
		<field name="tmpId" type="id"></field>
		<field name="partyIdFrom" type="value"></field>
		<field name="partyIdTo" type="value"></field>
		<field name="workEffortId" type="value"></field>
		<field name="payDate" type="value"></field>
		<field name="invoiceApplied" type="currency-amount"></field><!-- 应 -->
		<field name="amountApplied" type="currency-amount"></field><!-- 实 -->
		<prim-key field="tmpId"/>
	</entity>

<!-- 缴费人员视图 -->
	<view-entity entity-name="PartyPaymentInfoAndPerson">
		<member-entity entity-name="PartyPaymentInfo" entity-alias="PP"/>

		<member-entity entity-name="Person" entity-alias="P"/>

		<!-- 暂不关联Content -->
		<alias name="partyIdFrom" field="partyIdFrom" entity-alias="PP"/>
		<alias name="partyId" field="partyId" entity-alias="P"/>
		<alias name="workEffortId" field="workEffortId" entity-alias="PP"/>

		<alias name="payDate" field="payDate" entity-alias="PP"/>
		<alias name="invoiceApplied" field="invoiceApplied" entity-alias="PP"/>
		<alias name="amountApplied" field="amountApplied" entity-alias="PP"/>

		<alias name="firstName" field="firstName" entity-alias="P"/>
		<alias name="lastName" field="lastName" entity-alias="P"/>


		<view-link entity-alias="PP" rel-entity-alias="P">
			<key-map field-name="partyIdFrom" rel-field-name="partyId" />
		</view-link>

	</view-entity>

</entitymodel>